<div class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">

  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p>This is a demo notebook for the <a
              href="https://github.com/aheritianad/BootCamp-BlockChain-and-Python/">bcbcpy</a> package.</p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[1]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">bcbcpy</span>
<span class="k">except</span> <span class="ne">ModuleNotFoundError</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;../src/&quot;</span><span class="p">))</span>
    <span class="kn">import</span> <span class="nn">bcbcpy</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h1 id="Cryptography">Cryptography<a class="anchor-link" href="#Cryptography">&#182;</a></h1>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[2]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="kn">from</span> <span class="nn">bcbcpy</span> <span class="kn">import</span> <span class="n">crypto</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h2 id="Hashing">Hashing<a class="anchor-link" href="#Hashing">&#182;</a></h2>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Hash-function"><code>Hash</code> function<a class="anchor-link" href="#Hash-function">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          $$\mathfrak{h}: X \to H$$<ul>
            <li>$\mathfrak{h}(x) = \mathfrak{h}(y)$ <em>only if</em> $x=y$.</li>
            <li>given $h\in H$, it is <em>not easy</em> to find $x\in X$ such that $\mathfrak{h}(x) = h$.</li>
          </ul>
          <p>In some sense, $\mathfrak{h}(x)$ is a signature of $x$.</p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[3]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">text_to_be_hashed</span> <span class="o">=</span> <span class="s2">&quot;Hello World&quot;</span>
<span class="n">first_hash</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">hash_function</span><span class="p">(</span><span class="n">text_to_be_hashed</span><span class="p">,</span> <span class="n">hash_name</span><span class="o">=</span><span class="n">crypto</span><span class="o">.</span><span class="n">HashName</span><span class="o">.</span><span class="n">sha256</span><span class="p">)</span>
<span class="n">first_hash</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[3]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;1370eeaaba7a6c7a234b1f82cc3b6d013a0088fd5e16408300f05b28b0015463&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[4]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">crypto</span><span class="o">.</span><span class="n">hash_function</span><span class="p">(</span><span class="n">text_to_be_hashed</span> <span class="o">+</span> <span class="s2">&quot;!&quot;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[4]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;e59f8bdf1305e382a4919ccefd613d3eebae612aa4c443f3af2d65663de3b075&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[5]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">crypto</span><span class="o">.</span><span class="n">hash_function</span><span class="p">(</span><span class="s2">&quot;Hello World!&quot;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[5]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;e59f8bdf1305e382a4919ccefd613d3eebae612aa4c443f3af2d65663de3b075&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[6]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">long_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Hello everyone!</span>

<span class="s2">Welcome to this tutorial.</span>
<span class="s2">I promise that I will do my best to help you.</span>

<span class="s2">It will be interactive, so please participate as much as you can.</span>

<span class="s2">Please do not hesitate to ask if there you have questions.</span>

<span class="s2">Hope you will enjoy it!</span>

<span class="s2">Cheers!</span>

<span class="s2">Heritiana.</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[7]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">hash_long</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">hash_function</span><span class="p">(</span><span class="n">long_text</span><span class="p">)</span>
<span class="n">hash_long</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[7]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;0c8359860bef1b26f811bf8448c546c2241c7c695f9b8ee76c1a8bf2d5b2dff3&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[8]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">hash_long</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_hash</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[8]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>True</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Validation">Validation<a class="anchor-link" href="#Validation">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[9]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">difficulty</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">crypto</span><span class="o">.</span><span class="n">is_valid_hash</span><span class="p">(</span><span class="n">first_hash</span><span class="p">,</span> <span class="n">difficulty</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[9]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>False</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[10]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">fake_hash</span> <span class="o">=</span> <span class="s2">&quot;0000&quot;</span> <span class="o">+</span> <span class="n">first_hash</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
<span class="n">fake_hash</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[10]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;0000eeaaba7a6c7a234b1f82cc3b6d013a0088fd5e16408300f05b28b0015463&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[11]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">crypto</span><span class="o">.</span><span class="n">is_valid_hash</span><span class="p">(</span><span class="n">fake_hash</span><span class="p">,</span> <span class="n">difficulty</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[11]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>True</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Nonce">Nonce<a class="anchor-link" href="#Nonce">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[12]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">second_hash</span><span class="p">,</span> <span class="n">nonce</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">hash_nonce_initializer</span><span class="p">(</span>
    <span class="n">text_to_be_hashed</span><span class="p">,</span> <span class="n">difficulty</span><span class="o">=</span><span class="n">difficulty</span>
<span class="p">)</span>
<span class="n">second_hash</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[12]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;0000bfe6af4232f78b0c8eba37a6ba6c17b9b8671473b0b82305880be077edd9&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[13]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">nonce</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[13]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>107105</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[14]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">crypto</span><span class="o">.</span><span class="n">is_valid_hash</span><span class="p">(</span><span class="n">second_hash</span><span class="p">,</span> <span class="n">difficulty</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[14]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>True</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[15]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">third_hash</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">hash_function</span><span class="p">(</span><span class="n">text_to_be_hashed</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">)</span>
<span class="n">third_hash</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[15]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;0000bfe6af4232f78b0c8eba37a6ba6c17b9b8671473b0b82305880be077edd9&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[16]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">second_hash</span> <span class="o">==</span> <span class="n">third_hash</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[16]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>True</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[17]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">forth_hash</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">hash_function</span><span class="p">(</span><span class="n">text_to_be_hashed</span><span class="p">,</span> <span class="n">nonce</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># type:ignore</span>
<span class="n">second_hash</span> <span class="o">==</span> <span class="n">forth_hash</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[17]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>True</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Q:-What-if-such-nonce-does-not-exist?">Q: What if such <code>nonce</code> does not exist?<a
              class="anchor-link" href="#Q:-What-if-such-nonce-does-not-exist?">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p><strong>Think about it.</strong></p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h2 id="Crypto">Crypto<a class="anchor-link" href="#Crypto">&#182;</a></h2>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Encryption-&amp;-Decryption"><code>Encryption</code> &amp; <code>Decryption</code><a
              class="anchor-link" href="#Encryption-&amp;-Decryption">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          $$f\circ f^{-1} (x) = f^{-1}\circ f(x) = x,\ \forall x$$
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[18]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">encrypt</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">decrypt</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span>  <span class="c1"># TODO to fill</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[19]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">encrypt</span><span class="p">(</span><span class="n">decrypt</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">encrypt</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="n">x</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Oops! fail at </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">-th attempt for x = </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">.&quot;</span>
<span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Congrats! I passes the test.&quot;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>Oops! fail at 1-th attempt for x = -2486.
</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[20]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">clear_message</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;This is a clear message to encrypt and decrypt. I add this to make it longer.&quot;</span>
<span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Types">Types<a class="anchor-link" href="#Types">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h4 id="Key">Key<a class="anchor-link" href="#Key">&#182;</a></h4>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p>$\mathcal{F}=\{ f_\theta \:\ \theta \in \Theta\}$</p>
          <p>$\left(f_{\theta}\right) ^{-1} = f_{\theta^\prime}$ for some $\theta^\prime \in \Theta$</p>
          <p>$\theta \in \Theta$ : key</p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h4 id="Symmetric">Symmetric<a class="anchor-link" href="#Symmetric">&#182;</a></h4>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p>Given $f_\theta$ or $\theta\in \Theta$ (thus $f_\theta$), one can construct <em>easily</em>
            $\left(f_\theta\right)^{-1}$.</p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p>From Wikipedia (2023-05-01):</p>
          <p><em>Symmetric-key algorithms are algorithms for cryptography that use the same cryptographic keys for both
              the encryption of plaintext and the decryption of ciphertext. The keys may be identical, or there may be a
              simple transformation to go between the two keys.</em></p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h5 id="Cesar">Cesar<a class="anchor-link" href="#Cesar">&#182;</a></h5>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p><strong>Idea</strong>: translation</p>
          <p>$N$ : number of character.<br />
            key: $ \theta \in \mathbb{Z}$<br />
            function: $f_\theta: x \mod N \mapsto (x + \theta) \mod N$<br />
            inverse: $\theta^\prime = -\theta$</p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[21]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">cesar_key</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">CesarKey</span><span class="o">.</span><span class="n">generate_key</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cesar_key</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>CesarKey(2, -2)
</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[22]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">crypto</span><span class="o">.</span><span class="n">CesarKey</span><span class="o">.</span><span class="n">compute_inverse</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[22]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>-6</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[23]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">encr_cesar</span> <span class="o">=</span> <span class="n">cesar_key</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">clear_message</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">original:</span>
<span class="s2">========</span>
<span class="si">{</span><span class="n">clear_message</span><span class="si">}</span><span class="s2"></span>

<span class="s2">Encrypted:</span>
<span class="s2">========</span>
<span class="si">{</span><span class="n">encr_cesar</span><span class="si">}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>
original:
========
This is a clear message to encrypt and decrypt. I add this to make it longer.

Encrypted:
========
Vjku&#34;ku&#34;c&#34;engct&#34;oguucig&#34;vq&#34;gpet{rv&#34;cpf&#34;fget{rv0&#34;K&#34;cff&#34;vjku&#34;vq&#34;ocmg&#34;kv&#34;nqpigt0

</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[24]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">decr</span> <span class="o">=</span> <span class="n">cesar_key</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encr_cesar</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">original:</span>
<span class="s2">========</span>
<span class="si">{</span><span class="n">clear_message</span><span class="si">}</span><span class="s2"></span>

<span class="s2">Decrypted:</span>
<span class="s2">=========</span>
<span class="si">{</span><span class="n">decr</span><span class="si">}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>
original:
========
This is a clear message to encrypt and decrypt. I add this to make it longer.

Decrypted:
=========
This is a clear message to encrypt and decrypt. I add this to make it longer.

</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h5 id="Permutation">Permutation<a class="anchor-link" href="#Permutation">&#182;</a></h5>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[25]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">crypto</span><span class="o">.</span><span class="n">PermutationKey</span><span class="o">.</span><span class="n">compute_inverse</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[25]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>[4, 1, 2, 3]</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h6 id="Idea1:-Chunking"><strong>Idea1: Chunking</strong><a class="anchor-link"
              href="#Idea1:-Chunking">&#182;</a></h6>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p>Chunk input with a chunk size equal to permutation length and apply permutation on each chunks.</p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[26]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">perm_key</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">PermutationKey</span><span class="o">.</span><span class="n">generate_key</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_runs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">perm_key</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>PermutationKey([3, 2, 1], [3, 2, 1])
</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[27]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">encr_perm</span> <span class="o">=</span> <span class="n">perm_key</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">clear_message</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">original:</span>
<span class="s2">========</span>
<span class="si">{</span><span class="n">clear_message</span><span class="si">}</span><span class="s2"></span>

<span class="s2">Encrypted:</span>
<span class="s2">========</span>
<span class="si">{</span><span class="n">encr_perm</span><span class="si">}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>
original:
========
This is a clear message to encrypt and decrypt. I add this to make it longer.

Encrypted:
========
ihTi sa slc raeem ass eg otcnepyra t dncedpyr .ta I ddihtt sm oekati ol egnr.

</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[28]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">decr</span> <span class="o">=</span> <span class="n">perm_key</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encr_perm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">original:</span>
<span class="s2">========</span>
<span class="si">{</span><span class="n">clear_message</span><span class="si">}</span><span class="s2"></span>

<span class="s2">Decrypted:</span>
<span class="s2">=========</span>
<span class="si">{</span><span class="n">decr</span><span class="si">}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>
original:
========
This is a clear message to encrypt and decrypt. I add this to make it longer.

Decrypted:
=========
This is a clear message to encrypt and decrypt. I add this to make it longer.

</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h6 id="Idea2:-Sliding"><strong>Idea2: Sliding</strong><a class="anchor-link"
              href="#Idea2:-Sliding">&#182;</a></h6>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p>One can think about sliding the permutation like the following.</p>
          <p>Suppose we have the following permutation
            $$\theta: \begin{cases}1\mapsto 3\\ 2\mapsto 2\\ 3\mapsto 1\end{cases}$$
            and input <code>abcdefgh</code>.</p>
          <ul>
            <li><code>input = abcdefgh</code></li>
            <li><code>abc defgh</code> $\to$ <code>cba defgh</code></li>
            <li><code>c bad efgh</code> $\to$ <code>c dab efgh</code></li>
            <li><code>cd abe fgh</code> $\to$ <code>cd eba fgh</code></li>
            <li><code>cde baf gh</code> $\to$ <code>cde fab gh</code></li>
            <li><code>cdef abg h</code> $\to$ <code>cdef gba h</code></li>
            <li><code>cdefg bah</code> $\to$ <code>cdefg hab</code></li>
            <li><code>output = cdefghab</code></li>
          </ul>
          <p>⚠️: the same process does not bring back <code>input</code> from output<br />
            It can be fixed by doing a tricky thing to the <em>previous output</em> to get the <em>final
              output</em>.<br />
            You can think about it and its implementation.</p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h5 id="Adding-noise">Adding noise<a class="anchor-link" href="#Adding-noise">&#182;</a></h5>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[29]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="kn">from</span> <span class="nn">bcbcpy</span> <span class="kn">import</span> <span class="n">utils</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[30]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">noisy_message</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">add_noises</span><span class="p">(</span><span class="n">clear_message</span><span class="p">)</span>
<span class="n">noisy_message</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[30]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#34;T|hpi[s- 7iGse +a&lt; 4c}lxeVarrq jmUeysQs&lt;aBg,eR {t$o+ Gekn/cmrWyCpNt% `a,n@dB /d$e8c&lt;rZyBp^t\n., [IB &#39;a\\d.dM Ht)hmiHsK ~t^of Tmda4k1eg NiytU lleojnWg ewrq.3&#34;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[31]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">noisy_message</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[31]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;This is a clear message to encrypt and decrypt. I add this to make it longer.&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[32]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">remove_noises</span><span class="p">(</span><span class="n">noisy_message</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[32]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;This is a clear message to encrypt and decrypt. I add this to make it longer.&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[33]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">encr_noisy</span> <span class="o">=</span> <span class="n">cesar_key</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">noisy_message</span><span class="p">)</span>
<span class="n">decr_noisy</span> <span class="o">=</span> <span class="n">cesar_key</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encr_noisy</span><span class="p">)</span>
<span class="n">decr_without_noise</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">remove_noises</span><span class="p">(</span><span class="n">decr_noisy</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="se">\t\t</span><span class="s2">--- CESAR --</span>
<span class="s2">Original:</span>
<span class="s2">========</span>
<span class="si">{</span><span class="n">clear_message</span><span class="si">}</span><span class="s2"></span>

<span class="s2">Noisy message:</span>
<span class="s2">=============</span>
<span class="si">{</span><span class="n">noisy_message</span><span class="si">}</span><span class="s2"></span>

<span class="s2">Noisy Encrypted:</span>
<span class="s2">===============</span>
<span class="si">{</span><span class="n">encr_noisy</span><span class="si">}</span><span class="s2"></span>

<span class="s2">Noisy Decrypted:</span>
<span class="s2">===============</span>
<span class="si">{</span><span class="n">decr_noisy</span><span class="si">}</span><span class="s2"></span>

<span class="s2">Cleaned Decrypted:</span>
<span class="s2">=================</span>
<span class="si">{</span><span class="n">decr_without_noise</span><span class="si">}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>
		--- CESAR --
Original:
========
This is a clear message to encrypt and decrypt. I add this to make it longer.

Noisy message:
=============
T|hpi[s- 7iGse +a&lt; 4c}lxeVarrq jmUeysQs&lt;aBg,eR {t$o+ Gekn/cmrWyCpNt% `a,n@dB /d$e8c&lt;rZyBp^t
., [IB &#39;a\d.dM Ht)hmiHsK ~t^of Tmda4k1eg NiytU lleojnWg ewrq.3

Noisy Encrypted:
===============
V~jrk]u/&#34;9kIug&#34;-c&gt;&#34;6e	nzgXctts&#34;loWg{uSu&gt;cDi.gT&#34;}v&amp;q-&#34;Igmp1eotY{ErPv&#39;&#34;bc.pBfD&#34;1f&amp;g:e&gt;t\{Dr`v!0.&#34;]KD&#34;)c^f0fO&#34;Jv+jokJuM&#34;
v`qh&#34;Vofc6m3gi&#34;Pk{vW&#34;nngqlpYi&#34;gyts05

Noisy Decrypted:
===============
T|hpi[s- 7iGse +a&lt; 4c}lxeVarrq jmUeysQs&lt;aBg,eR {t$o+ Gekn/cmrWyCpNt% `a,n@dB /d$e8c&lt;rZyBp^t
., [IB &#39;a\d.dM Ht)hmiHsK ~t^of Tmda4k1eg NiytU lleojnWg ewrq.3

Cleaned Decrypted:
=================
This is a clear message to encrypt and decrypt. I add this to make it longer.

</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[34]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">encr_noisy</span> <span class="o">=</span> <span class="n">perm_key</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">noisy_message</span><span class="p">)</span>
<span class="n">decr_noisy</span> <span class="o">=</span> <span class="n">perm_key</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encr_noisy</span><span class="p">)</span>
<span class="n">decr_without_noise</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">remove_noises</span><span class="p">(</span><span class="n">decr_noisy</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="se">\t\t</span><span class="s2">--- PERMUTATION ---</span>
<span class="s2">Original:</span>
<span class="s2">========</span>
<span class="si">{</span><span class="n">clear_message</span><span class="si">}</span><span class="s2"></span>

<span class="s2">Noisy message:</span>
<span class="s2">=============</span>
<span class="si">{</span><span class="n">noisy_message</span><span class="si">}</span><span class="s2"></span>

<span class="s2">Noisy Encrypted:</span>
<span class="s2">===============</span>
<span class="si">{</span><span class="n">encr_noisy</span><span class="si">}</span><span class="s2"></span>

<span class="s2">Noisy Decrypted:</span>
<span class="s2">===============</span>
<span class="si">{</span><span class="n">decr_noisy</span><span class="si">}</span><span class="s2"></span>

<span class="s2">Cleaned Decrypted:</span>
<span class="s2">=================</span>
<span class="si">{</span><span class="n">decr_without_noise</span><span class="si">}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>
		--- PERMUTATION ---
Original:
========
This is a clear message to encrypt and decrypt. I add this to make it longer.

Noisy message:
=============
T|hpi[s- 7iGse +a&lt; 4c}lxeVarrq jmUeysQs&lt;aBg,eR {t$o+ Gekn/cmrWyCpNt% `a,n@dB /d$e8c&lt;rZyBp^t
., [IB &#39;a\d.dM Ht)hmiHsK ~t^of Tmda4k1eg NiytU lleojnWg ewrq.3

Noisy Encrypted:
===============
h|T[ip -sGi7 es&lt;a+c4 xl}aVeqrrmj yeUsQsBa&lt;e,g{ Ro$tG +nkemc/yWrNpC %t,a`d@n/ Be$d&lt;c8yZr^pB.
t[ , BI\a&#39;d.dH Mh)tHim Ks^t~ fodmTk4age1iN Utyll joegWnwe .qr3

Noisy Decrypted:
===============
T|hpi[s- 7iGse +a&lt; 4c}lxeVarrq jmUeysQs&lt;aBg,eR {t$o+ Gekn/cmrWyCpNt% `a,n@dB /d$e8c&lt;rZyBp^t
., [IB &#39;a\d.dM Ht)hmiHsK ~t^of Tmda4k1eg NiytU lleojnWg ewrq.3

Cleaned Decrypted:
=================
This is a clear message to encrypt and decrypt. I add this to make it longer.

</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h4 id="Asymmetric:-Public-key-cryptography">Asymmetric: Public-key cryptography<a class="anchor-link"
              href="#Asymmetric:-Public-key-cryptography">&#182;</a></h4>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p>Knowing $f_\theta$ or $\theta\in \Theta$ (thus $f_\theta$) does <strong>NOT</strong> make the construction
            of $\left(f_\theta\right)^{-1}$ (thus $\theta^\prime$) <em>easy</em>.</p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p>From Wikipedia (2023-05-01):</p>
          <p><em>Public-key cryptography, or asymmetric cryptography, is the field of cryptographic systems that use
              pairs of related keys. Each key pair consists of a public key and a corresponding private key. Key pairs
              are generated with cryptographic algorithms based on mathematical problems termed one-way functions.
              Security of public-key cryptography depends on keeping the private key secret; the public key can be
              openly distributed without compromising security.</em></p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h5 id="Rivest%E2%80%93Shamir%E2%80%93Adleman-aka-RSA">Rivest&#8211;Shamir&#8211;Adleman aka RSA<a
              class="anchor-link" href="#Rivest%E2%80%93Shamir%E2%80%93Adleman-aka-RSA">&#182;</a></h5>
          <p>(<a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem))">wikipedia</a></p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p>$\Theta \approx \mathbb{N} \times \mathbb{N}$<br />
            public key: $\theta = (n,d)$<br />
            private key: $\theta^\prime = (n,e)$<br />
            function: $f_{(n,a)}: x\mod n \mapsto x^a \mod n$</p>
          <p><strong>Construction</strong>:</p>
          <ol>
            <li>Generate two primes $p,q$.</li>
            <li>Compute $n=p\times q$.</li>
            <li>Compute $\varphi(n) = (p-1)*(q-1)$.</li>
            <li>Find $d$ such that $\gcd\left( d, \varphi(n)\right) = 1$.</li>
            <li>Find $e$ such that $de + u\varphi(n)=1$ for some $u\in \mathbb{Z}$.</li>
            <li>Discard $p,q,\varphi(n)$ and $u$ <em>(for security)</em>.</li>
          </ol>
          <p>Note: [4.] and [5.] can be done easily and at once with the extended Euclidean algorithm.</p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p><strong>:warning: Security</strong>: number factorization complexity</p>
          <p>For large composite number $n$, computing $\varphi(n)$ is not <em>easy</em> without knowing its prime
            factors.</p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[35]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">rsa_key</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAPairKeys</span><span class="o">.</span><span class="n">generate_pairs</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rsa_key</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>RSAPairKeys((7313, 4997), HIDDEN_KEY)
</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[36]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">rsa_pub</span><span class="p">,</span> <span class="n">rsa_priv</span> <span class="o">=</span> <span class="n">rsa_key</span>
<span class="n">rsa_pub</span><span class="p">,</span> <span class="n">rsa_priv</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[36]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>((7313, 4997), (7313, 713))</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[37]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">encr_rsa</span> <span class="o">=</span> <span class="n">rsa_key</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">clear_message</span><span class="p">)</span>
<span class="n">encr_rsa</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[37]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;[\n&#34;&lt;rsachunkrsa&gt;/8Q&amp;j&gt;&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;-z0NOf&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;- OcF\\&#34;&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;2\\&#34;gyi[&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;D[_\\niH&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;*t]H!\&#39;&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;,@d_hq&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;D[I[nX&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;-f)$k;&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;8QgG-O&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;D[Kbx7&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;Foo\&#39;r&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;*tQXs &lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;$9@Ab(&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;G&lt;qgCv&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;\\nKd&lt;/rsachunkrsa&gt;&#34;\n]&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[38]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">decr_rsa</span> <span class="o">=</span> <span class="n">rsa_key</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encr_rsa</span><span class="p">)</span>
<span class="n">decr_rsa</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[38]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;[\n&#34;&lt;rsachunkrsa&gt;This &lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;is a &lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;clear&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt; mess&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;age t&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;o enc&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;rypt &lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;and d&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;ecryp&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;t. I &lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;add t&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;his t&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;o mak&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;e it &lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;longe&lt;/rsachunkrsa&gt;&#34;,\n&#34;&lt;rsachunkrsa&gt;r.&lt;/rsachunkrsa&gt;&#34;\n]&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[39]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="kn">from</span> <span class="nn">bcbcpy.crypto</span> <span class="kn">import</span> <span class="n">read_from_rsa</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[40]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">encr_rsa</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[40]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;/8Q&amp;j&gt;-z0NOf- OcF&#34;2&#34;gyi[D[_\niH*t]H!\&#39;,@d_hqD[I[nX-f)$k;8QgG-OD[Kbx7Foo\&#39;r*tQXs $9@Ab(G&lt;qgCv\nKd&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[41]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">decr_rsa</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[41]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;This is a clear message to encrypt and decrypt. I add this to make it longer.&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[42]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">rsa_key</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAPairKeys</span><span class="o">.</span><span class="n">generate_pairs</span><span class="p">()</span>
<span class="n">encr_rsa</span> <span class="o">=</span> <span class="n">rsa_key</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">clear_message</span><span class="p">)</span>
<span class="n">encr_rsa</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[42]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;[\n&#34;&lt;rsachunkrsa&gt;=#_GmL)M6SsjvN*{G(oK(czX9f`Nr$7:m~) !W1=evK\\n\\tz2!leC\\\\fHWw7-sTkvQ9ATd^/:i|RQ{WS*&lt;/rsachunkrsa&gt;&#34;\n]&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[43]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">decr_rsa</span> <span class="o">=</span> <span class="n">rsa_key</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encr_rsa</span><span class="p">)</span>
<span class="n">decr_rsa</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[43]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;[\n&#34;&lt;rsachunkrsa&gt;This is a clear message to encrypt and decrypt. I add this to make it longer.&lt;/rsachunkrsa&gt;&#34;\n]&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h5 id="Diffie%E2%80%93Hellman-key-exchange">Diffie&#8211;Hellman key exchange<a class="anchor-link"
              href="#Diffie%E2%80%93Hellman-key-exchange">&#182;</a></h5>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <ol>
            <li>The network will:<ul>
                <li>choose a shared group $(G,*)$,</li>
                <li>an element $g\in G$,</li>
                <li>and compute $ord(g) \in \mathbb{N}$ for which is the smallest where $ord(g)\cdot g :=
                  \underbrace{g*g*\cdots*g}_{ord(g) \text{ times}}$ is equal to the neutral element of $G$.</li>
              </ul>
            </li>
            <li>For each $i$ in the network:<ul>
                <li>Choose $\theta^\prime_i \in \mathbb{N}$ such that $\theta^\prime_i &lt; ord(g)$.</li>
                <li>Compute $f_{\theta_i} = \theta^\prime_i \dot g$.</li>
                <li>Publish $f_{\theta_i}$ and keep $\theta^\prime_i$ secret.</li>
              </ul>
            </li>
          </ol>
          <p>If $i$ wants to send a message $m$ to $j$, he will proceed as follows:</p>
          <ol>
            <li>retrieve $f_{\theta_j}$,</li>
            <li>compute $P_{ij} := \theta_i \cdot f_{\theta_j}$,</li>
            <li>encrypt $m$ with $P_{ij}$ (like the symmetric fashion),</li>
            <li>send encrypted message $m_{ij}$ to $j$.</li>
          </ol>
          <p>When $j$ receives $m_{ij}$, he will:</p>
          <ol>
            <li>retrieve $f_{\theta_i}$,</li>
            <li>compute $P_{ji} := \theta_j \cdot f_{\theta_i}$,</li>
            <li>decrypt $m_{ij}$ with $P_{ji}$.</li>
          </ol>
          <p>Note:
            $$ \begin{align*}
            P_{ij}
            &amp;= \theta_i \cdot f_{\theta_j}&amp;\\
            &amp;= \underbrace{f_{\theta_j}*\cdots*f_{\theta_j}}_{\theta_i \text{ times}}&amp;\\
            &amp;= \underbrace{\left(\underbrace{g*\cdots*g}_{\theta_j \text{
            times}}\right)*\cdots*\left(\underbrace{g*\cdots*g}_{\theta_j \text{ times}}\right)}_{\theta_i \text{
            times}}&amp;\\
            &amp;= \underbrace{g*\cdots*g}_{\theta_i\theta_j \text{ times}}&amp;\\
            &amp;= \underbrace{\left(\underbrace{g*\cdots*g}_{\theta_j \text{
            times}}\right)*\cdots*\left(\underbrace{g*\cdots*g}_{\theta_i \text{ times}}\right)}_{\theta_j \text{
            times}}&amp;\\
            &amp;= \underbrace{f_{\theta_j}*\cdots*f_{\theta_i}}_{\theta_j \text{ times}}&amp;\\
            &amp;= \theta_j \cdot f_{\theta_i}&amp;\\
            &amp;= P_{ji}&amp;
            \end{align*}$$</p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p style="text-align: center;">
            <img src="https://upload.wikimedia.org/wikipedia/commons/4/46/Diffie-Hellman_Key_Exchange.svg">
          </p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p><strong>⚠️ Security</strong>: <em>discrete logarithm</em></p>
          <p>For some group (<a
              href="https://www.ibm.com/docs/en/zos/2.3.0?topic=SSLTBW_2.3.0%2Fcom.ibm.tcp.ipsec.ipsec.help.doc%2Fcom%2Fibm%2Ftcp%2Fipsec%2Fipsec%2FPS_DT_Adv_PFS.CB_Initiate.html">Diffie-Hellman
              Group</a>), knowing the value of $g$ and $n \cdot g$ does not lead to $n$ <em>easily</em>.</p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[44]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># coming soon</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h5 id="Elliptic-Curve-Cryptography">Elliptic Curve Cryptography<a class="anchor-link"
              href="#Elliptic-Curve-Cryptography">&#182;</a></h5>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p><a href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography">ECC</a> use the DH key exchange with
            Where the group $G$ is an <a
              href="https://en.wikipedia.org/wiki/Elliptic_curve#Elliptic_curves_over_finite_fields">elliptic curve over
              finite fields</a>.</p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[45]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="c1"># coming soon</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Communication-&amp;-Security">Communication &amp; Security<a class="anchor-link"
              href="#Communication-&amp;-Security">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h4 id="Nodes-generation">Nodes generation<a class="anchor-link" href="#Nodes-generation">&#182;</a></h4>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[46]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="kn">from</span> <span class="nn">bcbcpy.node</span> <span class="kn">import</span> <span class="n">Node</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[47]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">key</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAPairKeys</span><span class="o">.</span><span class="n">generate_pairs</span><span class="p">()</span>
<span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="n">node</span><span class="o">.</span><span class="n">id</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[47]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;user_87224&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[48]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">node</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[48]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&lt;bcbcpy.node.Node at 0x107319d50&gt;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[49]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="k">class</span> <span class="nc">RepNode</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_Node__keys</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># type:ignore</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[50]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">akey</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAPairKeys</span><span class="o">.</span><span class="n">generate_pairs</span><span class="p">()</span>
<span class="n">alice</span> <span class="o">=</span> <span class="n">RepNode</span><span class="p">(</span><span class="n">akey</span><span class="p">,</span> <span class="s2">&quot;Alice&quot;</span><span class="p">)</span>
<span class="n">alice</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[50]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>Alice : RSAPairKeys((7313, 4349), HIDDEN_KEY)</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[51]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">bkey</span> <span class="o">=</span>  <span class="n">crypto</span><span class="o">.</span><span class="n">RSAPairKeys</span><span class="o">.</span><span class="n">generate_pairs</span><span class="p">()</span>
<span class="n">bob</span> <span class="o">=</span> <span class="n">RepNode</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">bkey</span><span class="p">)</span>
<span class="n">bob</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[51]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>Bob : RSAPairKeys((7313, 2557), HIDDEN_KEY)</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[52]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">rkey</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAPairKeys</span><span class="o">.</span><span class="n">generate_pairs</span><span class="p">()</span>
<span class="n">random_guy</span> <span class="o">=</span> <span class="n">RepNode</span><span class="p">(</span><span class="n">rkey</span><span class="p">)</span>
<span class="n">random_guy</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[52]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>user_518690 : RSAPairKeys((7313, 4877), HIDDEN_KEY)</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h4 id="Communication">Communication<a class="anchor-link" href="#Communication">&#182;</a></h4>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[53]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">sender</span> <span class="o">=</span> <span class="n">alice</span>
<span class="n">receiver</span> <span class="o">=</span> <span class="n">bob</span>

<span class="n">plain_message</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;Hello Bob! This is Alice. Please send me $1000 to this account: (1234567890)&quot;</span>
<span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[54]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">cipher</span> <span class="o">=</span> <span class="n">sender</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">plain_message</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">cipher</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">read_from_rsa</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="n">out</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[54]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#34;Fy|R5/pTP&amp;v{ktMTfht8 Q&amp;GG_|2^wU0o\\!*{U8DZYb,7,/8C 2Z$k1&#39;;3b=Wg-:kBC5EN,wE~#W&#34;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[55]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">cipher</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sender</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="n">out</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[55]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;Hello Bob! This is Alice. Please send me $1000 to this account: (1234567890)&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h4 id="Attack">Attack<a class="anchor-link" href="#Attack">&#182;</a></h4>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h5 id="Reading-attack">Reading attack<a class="anchor-link" href="#Reading-attack">&#182;</a></h5>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[56]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">hacker</span> <span class="o">=</span> <span class="n">random_guy</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[57]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">hacker</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">cipher</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hacker</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="n">out</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[57]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;81/nJ(+44o1O,!&gt;8ge4$3($J&amp;P}L%)x|R.]Yd{,V;OS-?LJ~&gt;\\&lt;wa6c!uZ-iNzqeN`DN4YNr,]&gt;t&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[58]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">hacker</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span> <span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="n">out</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[58]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;7Pq.pCdQ:57;aTz =x o%,m%Vmo\n54Z3 :.VK)FgNjr!n0CK3i/0/0$tZ3XcE_vzMA9A3TX:&amp;\\OC&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h5 id="Q:-what-if-receiver.pub-==-receiver.priv?">Q: what if <code>receiver.pub == receiver.priv</code>?<a
              class="anchor-link" href="#Q:-what-if-receiver.pub-==-receiver.priv?">&#182;</a></h5>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[59]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">receiver_priv</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">_Node__keys</span>
<span class="n">receiver_pub</span> <span class="o">=</span> <span class="n">receiver_priv</span> <span class="c1"># fake pub for testing</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[60]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">hacker</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span> <span class="n">receiver_pub</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="c1"># out</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h5 id="Sending-attack">Sending attack<a class="anchor-link" href="#Sending-attack">&#182;</a></h5>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[61]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">scam_message</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;Hello Bob! This is Alice. Please send me $1000 to this account: (0987654321)&quot;</span>
<span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[62]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">scam_cipher</span><span class="o">=</span> <span class="n">hacker</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">scam_message</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">scam_cipher</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="n">out</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[62]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#34;Fy|R5/pTP&amp;v{ktMTfht8 Q&amp;GG_|2^wU0o\\!*{U8DZYb,7,/8C 2Z$k1&#39;;3b=Wg-:mQx[]G@kD1B-&#34;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[63]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">scam_cipher</span><span class="p">)</span>

<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sender</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="n">out</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[63]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;Hello Bob! This is Alice. Please send me $1000 to this account: (0987654321)&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Authentication">Authentication<a class="anchor-link" href="#Authentication">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p><strong>Problem</strong>: no way for the <code>receiver</code> to recognize the <em>true</em>
            <code>sender</code>.</p>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h4 id="Encryption">Encryption<a class="anchor-link" href="#Encryption">&#182;</a></h4>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[64]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">sender</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">plain_message</span><span class="p">)</span> <span class="o">==</span> <span class="n">sender</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">plain_message</span><span class="p">)</span> <span class="c1"># encrypt with sender.priv</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[64]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>True</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[65]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">signed_message</span> <span class="o">=</span> <span class="n">sender</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">plain_message</span><span class="p">)</span> 
<span class="n">cipher_signed</span> <span class="o">=</span> <span class="n">sender</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">signed_message</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>
<span class="n">cipher_signed</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[65]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;[\n&#34;&lt;rsachunkrsa&gt;\\&#34;Psc\\t23&amp;Fm(\\&#34;OQU7NGZLu\\nIz7;i?\\\\F;&lt;bmR\\n+%@l!0iR7\\&#34;&amp;qZ&amp;?V`+f~8+v\\n]FAPKnZh\\t=7sbE8f&lt;/rsachunkrsa&gt;&#34;\n]&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[66]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">with_noise</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">add_noises</span><span class="p">(</span><span class="n">plain_message</span><span class="p">)</span>
<span class="n">signed_with_noise</span> <span class="o">=</span> <span class="n">sender</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">with_noise</span><span class="p">)</span> 
<span class="n">cipher_signed_with_noise</span> <span class="o">=</span> <span class="n">sender</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">signed_with_noise</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>
<span class="n">cipher_signed_with_noise</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[66]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;[\n&#34;&lt;rsachunkrsa&gt;AyXdWqrk+0k4iuX2+t8eA&amp;w)v3m,u0rp[@+x)?Ab@LJ?ptw\\nIFs]uzYrT8\\\\Ss3o:v_QuE(6,s%e&gt;&amp;[7S6JC.&gt;~Jv_lHnfa{XHl*8\\&#34;!J w{b\\n0qp$^a2N0F\&#39;D#%1Nx\\n$gQ:o\\n}kqW\\n[jsE]c&amp;\\&#34;(8G?lGS&lt;/rsachunkrsa&gt;&#34;\n]&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h5 id="Shortcut">Shortcut<a class="anchor-link" href="#Shortcut">&#182;</a></h5>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[67]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">cipher_signed</span> <span class="o">==</span> <span class="n">sender</span><span class="o">.</span><span class="n">sends</span><span class="p">(</span><span class="n">plain_message</span><span class="p">,</span> <span class="n">_to</span><span class="o">=</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[67]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>True</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[68]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">cipher_signed</span> <span class="o">==</span> <span class="n">sender</span><span class="o">.</span><span class="n">sends</span><span class="p">(</span><span class="n">plain_message</span><span class="p">,</span> <span class="n">_to</span><span class="o">=</span><span class="n">receiver</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[68]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>True</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[69]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">cipher_signed_with_noise_bis</span> <span class="o">=</span> <span class="n">sender</span><span class="o">.</span><span class="n">sends</span><span class="p">(</span><span class="n">plain_message</span><span class="p">,</span> <span class="n">_to</span><span class="o">=</span><span class="n">receiver</span><span class="p">,</span> <span class="n">_with_noises</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cipher_signed_with_noise_bis</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[69]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;NoIsYnOiSy[\n&#34;&lt;rsachunkrsa&gt;D-i^ko\\&#34;\\&#34;9&amp;`f=9hr-NW{Fq/)g|Aaf9Lq-f]J@{5}|P0WEguAE,:r,]eOHR@sD-HnFZU~AgH AUXk\\&#34;Cv0XB ~f9a2AWs;FRcc`-D\\\\:y{$iH!@u@NsUlMug*NQ|Ee\\\\jkjF6T@i3j0sUvNU%9YQG/dx&lt;H{2&lt;/rsachunkrsa&gt;&#34;\n]NoIsYnOiSy&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[70]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">cipher_signed_with_noise_bis</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span> <span class="c1"># trim NoIsYnOiSy</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[70]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;[\n&#34;&lt;rsachunkrsa&gt;D-i^ko\\&#34;\\&#34;9&amp;`f=9hr-NW{Fq/)g|Aaf9Lq-f]J@{5}|P0WEguAE,:r,]eOHR@sD-HnFZU~AgH AUXk\\&#34;Cv0XB ~f9a2AWs;FRcc`-D\\\\:y{$iH!@u@NsUlMug*NQ|Ee\\\\jkjF6T@i3j0sUvNU%9YQG/dx&lt;H{2&lt;/rsachunkrsa&gt;&#34;\n]&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[71]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">cipher_signed_with_noise</span> <span class="o">==</span> <span class="n">cipher_signed_with_noise_bis</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[71]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>False</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h5 id="Q:-Do-you-know-why-is-it-False?">Q: Do you know why is it <code>False</code>?<a class="anchor-link"
              href="#Q:-Do-you-know-why-is-it-False?">&#182;</a></h5>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h4 id="Decryption">Decryption<a class="anchor-link" href="#Decryption">&#182;</a></h4>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[72]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">signed_message</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">cipher_signed</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">signed_message</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">sender</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span> <span class="c1"># remove signature</span>

<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sender</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="n">out</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[72]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;Hello Bob! This is Alice. Please send me $1000 to this account: (1234567890)&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[73]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">signed_message_with_noise</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">cipher_signed_with_noise</span><span class="p">)</span>
<span class="n">message_with_noise</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">signed_message_with_noise</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">sender</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span> <span class="c1"># unsign</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sender</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">message_with_noise</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">message_with_noise</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">remove_noises</span><span class="p">(</span><span class="n">message_with_noise</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[73]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;Hello Bob! This is Alice. Please send me $1000 to this account: (1234567890)&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[74]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">trimmed_cipher_signed_with_noise</span> <span class="o">=</span> <span class="n">cipher_signed_with_noise_bis</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span>

<span class="n">signed_message_with_noise</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">trimmed_cipher_signed_with_noise</span><span class="p">)</span>
<span class="n">message_with_noise</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">signed_message_with_noise</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">sender</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span> <span class="c1"># unsign</span>

<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sender</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">message_with_noise</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">message_with_noise</span><span class="p">)</span>
    
<span class="n">utils</span><span class="o">.</span><span class="n">remove_noises</span><span class="p">(</span><span class="n">message_with_noise</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[74]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;Hello Bob! This is Alice. Please send me $1000 to this account: (1234567890)&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h5 id="Shortcut">Shortcut<a class="anchor-link" href="#Shortcut">&#182;</a></h5>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[75]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">receiver</span><span class="o">.</span><span class="n">gets</span><span class="p">(</span><span class="n">cipher_signed</span><span class="p">,</span> <span class="n">_from</span><span class="o">=</span><span class="n">sender</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[75]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;Hello Bob! This is Alice. Please send me $1000 to this account: (1234567890)&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[76]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">remove_noises</span><span class="p">(</span><span class="n">receiver</span><span class="o">.</span><span class="n">gets</span><span class="p">(</span><span class="n">cipher_signed_with_noise</span><span class="p">,</span> <span class="n">_from</span><span class="o">=</span><span class="n">sender</span><span class="p">))</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[76]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;Hello Bob! This is Alice. Please send me $1000 to this account: (1234567890)&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[77]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">receiver</span><span class="o">.</span><span class="n">gets</span><span class="p">(</span><span class="n">cipher_signed_with_noise_bis</span><span class="p">,</span> <span class="n">_from</span><span class="o">=</span><span class="n">sender</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[77]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;Hello Bob! This is Alice. Please send me $1000 to this account: (1234567890)&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h4 id="Attacks">Attacks<a class="anchor-link" href="#Attacks">&#182;</a></h4>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h5 id="Reading-Attack">Reading Attack<a class="anchor-link" href="#Reading-Attack">&#182;</a></h5>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[78]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">hacker</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">cipher_signed</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hacker</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="n">out</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[78]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;)R@Ik:;sEWj.\&#39;E#fv\\8jtYW|&amp;e6lJ&#34;4kMY&amp;2S&#34;le5COj\nEB!t!=W5;]y-Z`PuzYt3(nH)6Ljt)d1&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[79]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">hacker</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">cipher_signed</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">sender</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>

<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hacker</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="n">out</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[79]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#34;Fy|R5/pTP&amp;v{ktMTfht8 Q&amp;GG_|2^wU0o\\!*{U8DZYb,7,/8C 2Z$k1&#39;;3b=Wg-:kBC5EN,wE~#W&#34;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[80]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">hacker</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">cipher_signed</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="n">out</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[80]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#34;0y[P#&amp;f(A?J5iNF\\d/Mx1VzZ*v^.vA&lt;,gY-E{mqcX1~KYA#6y{brJ2Fq$-\t2yPqPq]0&#39;+;~=~NPf&#34;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[81]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">hacker</span><span class="o">.</span><span class="n">sends</span><span class="p">(</span><span class="n">cipher_signed</span><span class="p">,</span> <span class="n">_to</span><span class="o">=</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="n">out</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[81]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;$nni2V!kcm9 x} &#34;\&#39;%lgM:M&#34;S^m&lt;^&lt;C~`o:08ad\n+{Q\n?S0`Pfcg6[nattT|[s6M9xic1d&amp;;!s/3&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[82]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">hacker</span><span class="o">.</span><span class="n">gets</span><span class="p">(</span><span class="n">cipher_signed</span><span class="p">,</span> <span class="n">_from</span><span class="o">=</span><span class="n">sender</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[82]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;81/nJ(+44o1O,!&gt;8ge4$3($J&amp;P}L%)x|R.]Yd{,V;OS-?LJ~&gt;\\&lt;wa6c!uZ-iNzqeN`DN4YNr,]&gt;t&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[83]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">hacker</span><span class="o">.</span><span class="n">gets</span><span class="p">(</span><span class="n">cipher_signed</span><span class="p">,</span> <span class="n">_from</span><span class="o">=</span><span class="n">bob</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[83]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;$nni2V!kcm9 x} &#34;\&#39;%lgM:M&#34;S^m&lt;^&lt;C~`o:08ad\n+{Q\n?S0`Pfcg6[nattT|[s6M9xic1d&amp;;!s/3&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h5 id="Sending-Attack">Sending Attack<a class="anchor-link" href="#Sending-Attack">&#182;</a></h5>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[84]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Original:</span>
<span class="s2">========</span>
<span class="si">{</span><span class="n">plain_message</span><span class="si">}</span><span class="s2"></span>

<span class="s2">Scam:</span>
<span class="s2">=====</span>
<span class="si">{</span><span class="n">scam_message</span><span class="si">}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>
Original:
========
Hello Bob! This is Alice. Please send me $1000 to this account: (1234567890)

Scam:
=====
Hello Bob! This is Alice. Please send me $1000 to this account: (0987654321)

</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[85]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">non_signed_scam</span> <span class="o">=</span> <span class="n">hacker</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">scam_message</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>

<span class="n">receiver</span><span class="o">.</span><span class="n">gets</span><span class="p">(</span><span class="n">non_signed_scam</span><span class="p">,</span> <span class="n">_from</span><span class="o">=</span><span class="n">sender</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[85]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;A2^zvkWvZiAbm5HN]EvSgPZj:)H5PJ*E\\/~:_C-gF\n.u*dwFNz\\kBSqSS05+z/Xs`cMdDVb1hv=!&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[86]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">non_signed_scam</span> <span class="o">=</span> <span class="n">hacker</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">scam_message</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">sender</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>

<span class="n">receiver</span><span class="o">.</span><span class="n">gets</span><span class="p">(</span><span class="n">non_signed_scam</span><span class="p">,</span> <span class="n">_from</span><span class="o">=</span><span class="n">sender</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[86]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;2`l0P/F`S&#34;[V#|%X3mFXF}UJIpcEDX\\Y`hRyhbqD\\5eF5mhE=5`!j:scwN0&gt;HwBv}(`&amp;uvg=sEfW&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[87]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">signed_scam</span> <span class="o">=</span> <span class="n">hacker</span><span class="o">.</span><span class="n">sends</span><span class="p">(</span><span class="n">scam_message</span><span class="p">,</span> <span class="n">_to</span><span class="o">=</span><span class="n">receiver</span><span class="p">)</span>

<span class="n">receiver</span><span class="o">.</span><span class="n">gets</span><span class="p">(</span><span class="n">signed_scam</span><span class="p">,</span> <span class="n">_from</span><span class="o">=</span><span class="n">sender</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[87]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;7} t%&lt;|l}&lt;F_&#34;q#m+ZtHQsX.Rv{e]U\\T|iF5(:s\&#39;6X6{|*N{90kqr3vV\&#39;i!C#y9}a&gt;gFLP&gt;AUWnt&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h5 id="Possible-Weakness">Possible Weakness<a class="anchor-link" href="#Possible-Weakness">&#182;</a></h5>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[88]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">leaked_sender_priv</span> <span class="o">=</span> <span class="n">sender</span><span class="o">.</span><span class="n">_Node__keys</span>  <span class="c1"># key of alice = expected sender</span>

<span class="n">fake_signed_scam</span> <span class="o">=</span> <span class="n">hacker</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">scam_message</span><span class="p">,</span> <span class="n">leaked_sender_priv</span><span class="p">)</span>
<span class="n">cipher_fake_signed_scam</span> <span class="o">=</span> <span class="n">hacker</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">fake_signed_scam</span><span class="p">,</span> <span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">cipher_fake_signed_scam</span>

<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="n">out</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[88]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;&#34;Psc\t23&amp;Fm(&#34;OQU7NGZLu\nIz7;i?\\F;&lt;bmR\n+%@l!0iR7&#34;&amp;qZ&amp;?V`+f~8+v\n]FAPNq#mb@/F#vNW&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[89]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">receiver</span><span class="o">.</span><span class="n">gets</span><span class="p">(</span><span class="n">cipher_fake_signed_scam</span><span class="p">,</span> <span class="n">_from</span><span class="o">=</span><span class="n">sender</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[89]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;Hello Bob! This is Alice. Please send me $1000 to this account: (0987654321)&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h1 id="Blockchain">Blockchain<a class="anchor-link" href="#Blockchain">&#182;</a></h1>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[90]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="kn">from</span> <span class="nn">bcbcpy</span> <span class="kn">import</span> <span class="n">blockchain</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h2 id="Recap:-Data-Structure">Recap: Data Structure<a class="anchor-link"
              href="#Recap:-Data-Structure">&#182;</a></h2>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="List---Array">List - Array<a class="anchor-link" href="#List---Array">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span> 
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Linked-List">Linked List<a class="anchor-link" href="#Linked-List">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span> 
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h2 id="Block">Block<a class="anchor-link" href="#Block">&#182;</a></h2>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[91]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="kn">from</span> <span class="nn">bcbcpy.blockchain.block</span> <span class="kn">import</span> <span class="n">InitialBlock</span><span class="p">,</span> <span class="n">Block</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Initial-Block">Initial Block<a class="anchor-link" href="#Initial-Block">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[92]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">init_block</span> <span class="o">=</span> <span class="n">InitialBlock</span><span class="p">(</span><span class="n">initial_data</span><span class="o">=</span><span class="s2">&quot;initial data&quot;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[93]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">init_block</span><span class="o">.</span><span class="n">data</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[93]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;initial data&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[94]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">init_block</span><span class="o">.</span><span class="n">hash</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[94]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>&#39;00002d64bd7129caa2aa8ec458081519ac26034158e60962f6fd1428e22b1036&#39;</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[95]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">init_block</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[95]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;prev_hash&#34;: &#34;&#34;,
    &#34;hash&#34;: &#34;00002d64bd7129caa2aa8ec458081519ac26034158e60962f6fd1428e22b1036&#34;,
    &#34;data&#34;: &#34;initial data&#34;,
    &#34;nonce&#34;: 26206
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Block-Data">Block Data<a class="anchor-link" href="#Block-Data">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[96]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">second_block</span> <span class="o">=</span> <span class="n">Block</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s2">&quot;second data&quot;</span><span class="p">,</span> <span class="n">prev_block</span><span class="o">=</span> <span class="n">init_block</span><span class="p">)</span>
<span class="n">second_block</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[96]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;prev_hash&#34;: &#34;00002d64bd7129caa2aa8ec458081519ac26034158e60962f6fd1428e22b1036&#34;,
    &#34;hash&#34;: &#34;ac19b9c98cc9a1655bd66662c552b8667c2140a451ce635b24aa2fdf34555aea&#34;,
    &#34;data&#34;: &#34;second data&#34;,
    &#34;nonce&#34;: 0
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[97]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">second_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[97]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>False</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[98]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">second_block</span><span class="o">.</span><span class="n">mine</span><span class="p">()</span>
<span class="n">second_block</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[98]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;prev_hash&#34;: &#34;00002d64bd7129caa2aa8ec458081519ac26034158e60962f6fd1428e22b1036&#34;,
    &#34;hash&#34;: &#34;0000f1a7cc9b3335858fdc615b274e07568931de65e82fb991ac257e168b89c1&#34;,
    &#34;data&#34;: &#34;second data&#34;,
    &#34;nonce&#34;: 12005
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[99]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">second_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[99]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>True</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[100]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">third_block</span> <span class="o">=</span> <span class="n">Block</span><span class="p">(</span><span class="s2">&quot;third data&quot;</span><span class="p">,</span> <span class="n">prev_block</span><span class="o">=</span> <span class="n">second_block</span><span class="p">)</span>
<span class="n">third_block</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[100]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;prev_hash&#34;: &#34;0000f1a7cc9b3335858fdc615b274e07568931de65e82fb991ac257e168b89c1&#34;,
    &#34;hash&#34;: &#34;f94643bbf3edffb31b549ce63a5adbd4542b7e3b6d45f32ae69da4f9bc87b6f7&#34;,
    &#34;data&#34;: &#34;third data&#34;,
    &#34;nonce&#34;: 0
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[101]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">third_block</span><span class="o">.</span><span class="n">mine</span><span class="p">()</span>
<span class="n">third_block</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[101]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;prev_hash&#34;: &#34;0000f1a7cc9b3335858fdc615b274e07568931de65e82fb991ac257e168b89c1&#34;,
    &#34;hash&#34;: &#34;0000eecdfce497ff979154b54ddb7f8fe0114683c0102afb900cd93497951e80&#34;,
    &#34;data&#34;: &#34;third data&#34;,
    &#34;nonce&#34;: 2917
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[102]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">forth_block</span> <span class="o">=</span> <span class="n">Block</span><span class="p">(</span><span class="s2">&quot;forth data&quot;</span><span class="p">,</span> <span class="n">third_block</span><span class="p">)</span>
<span class="n">forth_block</span><span class="o">.</span><span class="n">mine</span><span class="p">()</span>
<span class="n">forth_block</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[102]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;prev_hash&#34;: &#34;0000eecdfce497ff979154b54ddb7f8fe0114683c0102afb900cd93497951e80&#34;,
    &#34;hash&#34;: &#34;00003e75b774fcf431090692c595e06fa5d05bc7730a63673e4e4304eb4faf6a&#34;,
    &#34;data&#34;: &#34;forth data&#34;,
    &#34;nonce&#34;: 101056
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[103]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">fifth_block</span> <span class="o">=</span> <span class="n">Block</span><span class="p">(</span><span class="s2">&quot;fifth block&quot;</span><span class="p">,</span> <span class="n">forth_block</span><span class="p">)</span>
<span class="n">fifth_block</span><span class="o">.</span><span class="n">mine</span><span class="p">()</span>
<span class="n">fifth_block</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[103]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;prev_hash&#34;: &#34;00003e75b774fcf431090692c595e06fa5d05bc7730a63673e4e4304eb4faf6a&#34;,
    &#34;hash&#34;: &#34;0000d8cb89717a6b1904bf4f44aab11529b3ee378d0256620f608c3dd73694b9&#34;,
    &#34;data&#34;: &#34;fifth block&#34;,
    &#34;nonce&#34;: 34705
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[104]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">init_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">second_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">third_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">forth_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">fifth_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[104]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>(True, True, True, True, True)</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Making-some-change-in-past-data">Making some change in past data<a class="anchor-link"
              href="#Making-some-change-in-past-data">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[105]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">third_block</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;not third data&quot;</span>
<span class="n">third_block</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[105]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;prev_hash&#34;: &#34;0000f1a7cc9b3335858fdc615b274e07568931de65e82fb991ac257e168b89c1&#34;,
    &#34;hash&#34;: &#34;66ad1a8ee995ddbcaaf131585222c10a396a960f0c441578d5613417fa5d107a&#34;,
    &#34;data&#34;: &#34;not third data&#34;,
    &#34;nonce&#34;: 2917
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[106]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">init_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">second_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">third_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">forth_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">fifth_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[106]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>(True, True, False, False, False)</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[107]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">third_block</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;third data&quot;</span>
<span class="n">init_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">second_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">third_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">forth_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">fifth_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[107]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>(True, True, True, True, True)</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[108]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">third_block</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;not third data&quot;</span>
<span class="n">third_block</span><span class="o">.</span><span class="n">mine</span><span class="p">()</span>
<span class="n">third_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[108]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>True</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[109]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">init_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">second_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">third_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">forth_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">fifth_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[109]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>(True, True, True, False, False)</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[110]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">third_block</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;third data&quot;</span>
<span class="n">third_block</span><span class="o">.</span><span class="n">mine</span><span class="p">()</span>
<span class="n">init_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">second_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">third_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">forth_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="n">fifth_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[110]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>(True, True, True, True, True)</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h2 id="Blockchain">Blockchain<a class="anchor-link" href="#Blockchain">&#182;</a></h2>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <p>A submodule is available at</p>
          <div class="highlight">
            <pre><span></span><span class="kn">from</span> <span class="nn">bcbcpy.blockchain</span> <span class="kn">import</span> <span class="n">chain</span>
</pre>
          </div>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Root">Root<a class="anchor-link" href="#Root">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[111]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">blockchain</span><span class="o">.</span><span class="n">RootChain</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[111]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;root_block&#34;: {
        &#34;hash&#34;: &#34;0000a456e7b5a5eb059e721fb431436883143101275c4077f83fe70298f5623d&#34;,
        &#34;data&#34;: &#34;&#34;
    }
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[112]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">initial_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;INITIAL AGREEMENT&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Bob&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;Alice&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">}}</span>

<span class="n">initial_data_string</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">obj2txt</span><span class="p">(</span><span class="n">initial_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">root_chain</span> <span class="o">=</span> <span class="n">blockchain</span><span class="o">.</span><span class="n">RootChain</span><span class="p">(</span><span class="n">initial_data_string</span><span class="p">,</span> <span class="n">difficulty</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">root_chain</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[112]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;root_block&#34;: {
        &#34;hash&#34;: &#34;0000579da420f2b62497716cc60e95a0f7ad46336c42062b7485a27fd91d99f0&#34;,
        &#34;data&#34;: &#34;{\n    \&#34;INITIAL ...&#34;
    }
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Chain">Chain<a class="anchor-link" href="#Chain">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[113]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">prev_block</span> <span class="o">=</span> <span class="n">root_chain</span><span class="o">.</span><span class="n">last_block</span>
<span class="n">new_block</span> <span class="o">=</span> <span class="n">Block</span><span class="p">(</span><span class="s2">&quot;new block&quot;</span><span class="p">,</span> <span class="n">prev_block</span><span class="p">)</span>
<span class="n">new_block</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[113]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;prev_hash&#34;: &#34;0000579da420f2b62497716cc60e95a0f7ad46336c42062b7485a27fd91d99f0&#34;,
    &#34;hash&#34;: &#34;73095d20a662a26d26eec210c0dc51c34816098cdab05f941487ee5e8133d6ad&#34;,
    &#34;data&#34;: &#34;new block&#34;,
    &#34;nonce&#34;: 0
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <hr />

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <div class="highlight">
            <pre><span></span><span class="n">root_chain</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span>
  <span class="n">new_block</span>
<span class="p">)</span>
</pre>
          </div>

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <hr />
          <div class="highlight">
            <pre><span></span>---------------------------------------------------------------------------
 AssertionError                            Traceback <span class="o">(</span>most recent call last<span class="o">)</span>
 /var/folders/x4/45r2t3bx5l3dc_b3tm_yz7380000gn/T/ipykernel_26354/943714534.py <span class="k">in</span> &lt;cell line: <span class="m">1</span>&gt;<span class="o">()</span>
 ----&gt; <span class="m">1</span> root_chain.add_block<span class="o">(</span>
       <span class="m">2</span>     new_block
       <span class="m">3</span> <span class="o">)</span>

 ~/Desktop/BootCamp-BlockChain-and-Python/src/bcbcpy/blockchain/chain.py <span class="k">in</span> add_block<span class="o">(</span>self, block<span class="o">)</span>
      <span class="m">26</span>             self.last_block is block.prev_block
      <span class="m">27</span>         <span class="o">)</span>, <span class="s2">&quot;Incompatible block to the head block of the chain.&quot;</span>
 ---&gt; <span class="m">28</span>         assert block.is_valid<span class="o">()</span>, <span class="s2">&quot;Block is not valid.&quot;</span>
      <span class="m">29</span>         self.last_block <span class="o">=</span> block
      <span class="m">30</span> 

 AssertionError: Block is not valid.
</pre>
          </div>
          <hr />

        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[114]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">new_block</span><span class="o">.</span><span class="n">mine</span><span class="p">()</span> <span class="c1"># validation</span>
<span class="n">new_block</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[114]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;prev_hash&#34;: &#34;0000579da420f2b62497716cc60e95a0f7ad46336c42062b7485a27fd91d99f0&#34;,
    &#34;hash&#34;: &#34;00007b581d241fea3fb8bf4c7c5c1941af9abb3a5ce05abb97b4521d34bab727&#34;,
    &#34;data&#34;: &#34;new block&#34;,
    &#34;nonce&#34;: 2823
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[115]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">root_chain</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span>
    <span class="n">new_block</span>
<span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[116]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">root_chain</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[116]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;root_block&#34;: {
        &#34;hash&#34;: &#34;0000579da420f2b62497716cc60e95a0f7ad46336c42062b7485a27fd91d99f0&#34;,
        &#34;data&#34;: &#34;{\n    \&#34;INITIAL ...&#34;
    },
    &#34;last_block&#34;: {
        &#34;hash&#34;: &#34;00007b581d241fea3fb8bf4c7c5c1941af9abb3a5ce05abb97b4521d34bab727&#34;,
        &#34;data&#34;: &#34;new block&#34;
    }
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[117]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">chain</span> <span class="o">=</span> <span class="n">blockchain</span><span class="o">.</span><span class="n">Chain</span><span class="p">(</span><span class="n">root_chain</span><span class="o">=</span><span class="n">root_chain</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s2">&quot;local network&quot;</span><span class="p">)</span>
<span class="n">chain</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[117]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;root_block&#34;: {
        &#34;hash&#34;: &#34;000015420debcdd55c00babc9c3a5a9c4ab22280cf9a6874986c427281dd79b9&#34;,
        &#34;data&#34;: &#34;local network&#34;
    }
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h2 id="Transaction">Transaction<a class="anchor-link" href="#Transaction">&#182;</a></h2>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[118]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="kn">from</span> <span class="nn">bcbcpy.blockchain.block</span> <span class="kn">import</span> <span class="n">transaction</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Nodes-setup">Nodes setup<a class="anchor-link" href="#Nodes-setup">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[119]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="kn">from</span> <span class="nn">bcbcpy.blockchain.node</span> <span class="kn">import</span> <span class="n">Node</span>

<span class="n">alice</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">crypto</span><span class="o">.</span><span class="n">RSAPairKeys</span><span class="o">.</span><span class="n">generate_pairs</span><span class="p">(),</span> <span class="s2">&quot;Alice&quot;</span><span class="p">)</span>
<span class="n">bob</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">crypto</span><span class="o">.</span><span class="n">RSAPairKeys</span><span class="o">.</span><span class="n">generate_pairs</span><span class="p">(),</span> <span class="s2">&quot;Bob&quot;</span><span class="p">)</span>
<span class="n">other_person_in_the_network</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">crypto</span><span class="o">.</span><span class="n">RSAPairKeys</span><span class="o">.</span><span class="n">generate_pairs</span><span class="p">())</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Transaction-Data">Transaction Data<a class="anchor-link" href="#Transaction-Data">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[120]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">assets</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">sender</span> <span class="o">=</span> <span class="n">bob</span>
<span class="n">receiver</span> <span class="o">=</span> <span class="n">alice</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[121]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">receiver_id</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">id</span>
<span class="n">receiver_pub</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">pub</span>

<span class="n">prev_block</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">last_block</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[122]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">transaction_data</span> <span class="o">=</span> <span class="n">transaction</span><span class="o">.</span><span class="n">TransactionData</span><span class="p">(</span>
    <span class="n">assets</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">receiver_id</span><span class="p">,</span> <span class="n">receiver_pub</span><span class="p">,</span> <span class="n">prev_block</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">transaction_data</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>{&#39;timestamp&#39;: &#39;2023-05-04T03:18:29.299250&#39;, &#39;sender_id&#39;: &#39;Bob&#39;, &#39;receiver_id&#39;: &#39;Alice&#39;, &#39;assets&#39;: 1000, &#39;prev_hash&#39;: &#39;000015420debcdd55c00babc9c3a5a9c4ab22280cf9a6874986c427281dd79b9&#39;, &#39;sender_confirmation&#39;: &#39;[\n&#34;&lt;rsachunkrsa&gt;  EcD0HM&amp;E@Kb+y fE\\t&gt;#s`F?)R}UU_~*[6Bch,)~{vK2yf1i?pBAF2dn7I#{D7d56h.oA/p&amp;tTg7urbPvx&amp;\\n^ca+\\t&gt;pwDOZ05oU6iT&amp;jz_I.}yte\\t@YE/38&amp;maGrf*xF&gt;~`i&lt;/rsachunkrsa&gt;&#34;\n]&#39;}
</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Transaction-Block">Transaction Block<a class="anchor-link" href="#Transaction-Block">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[123]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">transaction_block</span> <span class="o">=</span> <span class="n">blockchain</span><span class="o">.</span><span class="n">TransactionBlock</span><span class="p">(</span><span class="n">transaction_data</span><span class="p">)</span>
<span class="n">transaction_block</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[123]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;prev_hash&#34;: &#34;000015420debcdd55c00babc9c3a5a9c4ab22280cf9a6874986c427281dd79b9&#34;,
    &#34;hash&#34;: &#34;65222279c494ce87948c3fd34ee3b37436b482a9a0145252baf502d208aec57e&#34;,
    &#34;data&#34;: &#34;{&#39;timestamp&#39;: &#39;2023-05-04T03:18:29.299250&#39;, &#39;sender_id&#39;: &#39;Bob&#39;, &#39;receiver_id&#39;: &#39;Alice&#39;, &#39;assets&#39;: 1000, &#39;prev_hash&#39;: &#39;000015420debcdd55c00babc9c3a5a9c4ab22280cf9a6874986c427281dd79b9&#39;, &#39;sender_confirmation&#39;: &#39;[\\n\&#34;&lt;rsachunkrsa&gt;  EcD0HM&amp;E@Kb+y fE\\\\t&gt;#s`F?)R}UU_~*[6Bch,)~{vK2yf1i?pBAF2dn7I#{D7d56h.oA/p&amp;tTg7urbPvx&amp;\\\\n^ca+\\\\t&gt;pwDOZ05oU6iT&amp;jz_I.}yte\\\\t@YE/38&amp;maGrf*xF&gt;~`i&lt;/rsachunkrsa&gt;\&#34;\\n]&#39;}&#34;,
    &#34;nonce&#34;: 0
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Verification">Verification<a class="anchor-link" href="#Verification">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h4 id="Anyone-in-the-network">Anyone in the network<a class="anchor-link"
              href="#Anyone-in-the-network">&#182;</a></h4>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[124]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">transaction_block</span><span class="o">.</span><span class="n">data</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>{&#39;timestamp&#39;: &#39;2023-05-04T03:18:29.299250&#39;, &#39;sender_id&#39;: &#39;Bob&#39;, &#39;receiver_id&#39;: &#39;Alice&#39;, &#39;assets&#39;: 1000, &#39;prev_hash&#39;: &#39;000015420debcdd55c00babc9c3a5a9c4ab22280cf9a6874986c427281dd79b9&#39;, &#39;sender_confirmation&#39;: &#39;[\n&#34;&lt;rsachunkrsa&gt;  EcD0HM&amp;E@Kb+y fE\\t&gt;#s`F?)R}UU_~*[6Bch,)~{vK2yf1i?pBAF2dn7I#{D7d56h.oA/p&amp;tTg7urbPvx&amp;\\n^ca+\\t&gt;pwDOZ05oU6iT&amp;jz_I.}yte\\t@YE/38&amp;maGrf*xF&gt;~`i&lt;/rsachunkrsa&gt;&#34;\n]&#39;}
</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[125]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span><span class="s2">&quot;Sender confirmation below needs to be set manually due to dirty rsa output&quot;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr">
            <pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">Warning</span>                                   Traceback (most recent call last)
<span class="ansi-green-fg">/var/folders/x4/45r2t3bx5l3dc_b3tm_yz7380000gn/T/ipykernel_13998/1177164807.py</span> in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">raise</span> Warning<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Sender confirmation below needs to be set manually due to dirty rsa output&#34;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">Warning</span>: Sender confirmation below needs to be set manually due to dirty rsa output</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[126]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">sender_confirmation</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;[</span><span class="se">\n</span><span class="s2">&quot;&lt;rsachunkrsa&gt;  EcD0HM&amp;E@Kb+y fE</span><span class="se">\\</span><span class="s2">t&gt;#s`F?)R}UU_~*[6Bch,)~{vK2yf1i?pBAF2dn7I#{D7d56h.oA/p&amp;tTg7urbPvx&amp;</span><span class="se">\\</span><span class="s2">n^ca+</span><span class="se">\\</span><span class="s2">t&gt;pwDOZ05oU6iT&amp;jz_I.}yte</span><span class="se">\\</span><span class="s2">t@YE/38&amp;maGrf*xF&gt;~`i&lt;/rsachunkrsa&gt;&quot;</span><span class="se">\n</span><span class="s2">]&quot;&quot;&quot;</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">sender_confirmation</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>[
&#34;&lt;rsachunkrsa&gt;  EcD0HM&amp;E@Kb+y fE\t&gt;#s`F?)R}UU_~*[6Bch,)~{vK2yf1i?pBAF2dn7I#{D7d56h.oA/p&amp;tTg7urbPvx&amp;\n^ca+\t&gt;pwDOZ05oU6iT&amp;jz_I.}yte\t@YE/38&amp;maGrf*xF&gt;~`i&lt;/rsachunkrsa&gt;&#34;
]
</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[127]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">confirmation_string</span> <span class="o">=</span> <span class="n">other_person_in_the_network</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">sender_confirmation</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span> <span class="n">sender</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sender</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">confirmation_string</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">confirmation_string</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">confirmation_string</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>[[&#39;assets&#39;,	1000],
[&#39;receiver_pub&#39;,	(7313, 4457)],
[&#39;prev_hash&#39;,	000015420debcdd55c00babc9c3a5a9c4ab22280cf9a6874986c427281dd79b9]]
</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[128]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">hash</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>(7313, 4457)
000015420debcdd55c00babc9c3a5a9c4ab22280cf9a6874986c427281dd79b9
</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Block-Validation">Block Validation<a class="anchor-link" href="#Block-Validation">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[129]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">transaction_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[129]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>False</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[130]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">transaction_block</span><span class="o">.</span><span class="n">mine</span><span class="p">()</span>
<span class="n">transaction_block</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[130]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;prev_hash&#34;: &#34;000015420debcdd55c00babc9c3a5a9c4ab22280cf9a6874986c427281dd79b9&#34;,
    &#34;hash&#34;: &#34;000055561c459c463beba5f400067485cd6fd68ca3f860f7f35a49be7c095e4f&#34;,
    &#34;data&#34;: &#34;{&#39;timestamp&#39;: &#39;2023-05-04T03:18:29.299250&#39;, &#39;sender_id&#39;: &#39;Bob&#39;, &#39;receiver_id&#39;: &#39;Alice&#39;, &#39;assets&#39;: 1000, &#39;prev_hash&#39;: &#39;000015420debcdd55c00babc9c3a5a9c4ab22280cf9a6874986c427281dd79b9&#39;, &#39;sender_confirmation&#39;: &#39;[\\n\&#34;&lt;rsachunkrsa&gt;  EcD0HM&amp;E@Kb+y fE\\\\t&gt;#s`F?)R}UU_~*[6Bch,)~{vK2yf1i?pBAF2dn7I#{D7d56h.oA/p&amp;tTg7urbPvx&amp;\\\\n^ca+\\\\t&gt;pwDOZ05oU6iT&amp;jz_I.}yte\\\\t@YE/38&amp;maGrf*xF&gt;~`i&lt;/rsachunkrsa&gt;\&#34;\\n]&#39;}&#34;,
    &#34;nonce&#34;: 57254
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[131]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">transaction_block</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[131]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>True</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Adding-to-Chain">Adding to Chain<a class="anchor-link" href="#Adding-to-Chain">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[132]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">chain</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">transaction_block</span><span class="p">)</span>
<span class="n">chain</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[132]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;root_block&#34;: {
        &#34;hash&#34;: &#34;000015420debcdd55c00babc9c3a5a9c4ab22280cf9a6874986c427281dd79b9&#34;,
        &#34;data&#34;: &#34;local network&#34;
    },
    &#34;last_block&#34;: {
        &#34;hash&#34;: &#34;000055561c459c463beba5f400067485cd6fd68ca3f860f7f35a49be7c095e4f&#34;,
        &#34;data&#34;: &#34;{&#39;timestamp&#39;: &#39;...&#34;
    }
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h2 id="Second-Transaction">Second Transaction<a class="anchor-link" href="#Second-Transaction">&#182;</a>
          </h2>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[133]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">assets</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">sender</span> <span class="o">=</span> <span class="n">alice</span>
<span class="n">receiver</span> <span class="o">=</span> <span class="n">bob</span>
<span class="n">prev_block</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">last_block</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[134]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">transaction_block</span> <span class="o">=</span> <span class="n">sender</span><span class="o">.</span><span class="n">make_transaction_block</span><span class="p">(</span>
    <span class="n">assets</span><span class="o">=</span><span class="n">assets</span><span class="p">,</span>
    <span class="n">to</span><span class="o">=</span><span class="n">receiver</span><span class="p">,</span>
    <span class="n">prev_block</span><span class="o">=</span><span class="n">prev_block</span><span class="p">,</span>
<span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Verification-...">Verification ...<a class="anchor-link" href="#Verification-...">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[135]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">transaction_block</span><span class="o">.</span><span class="n">data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>{&#39;timestamp&#39;: &#39;2023-05-04T03:19:09.156649&#39;, &#39;sender_id&#39;: &#39;Alice&#39;, &#39;receiver_id&#39;: &#39;Bob&#39;, &#39;assets&#39;: 500, &#39;prev_hash&#39;: &#39;000055561c459c463beba5f400067485cd6fd68ca3f860f7f35a49be7c095e4f&#39;, &#39;sender_confirmation&#39;: &#39;[\n&#34;&lt;rsachunkrsa&gt; 5S*vJW]&lt;/}~!C#|rb9Gdp203+N75_7#(6D~rNm-aHE1c=hNo3ozk,_A4UZ)_eY\\tem/\\&#34;}:wx%oLVwAPknU1lt*DF-(68+1U^xXvE/*HlqG#ti:]f?2l\\n^TG77\&#39;]Kmp+,u/z&lt;/rsachunkrsa&gt;&#34;\n]&#39;}
</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[136]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span><span class="s2">&quot;Sender confirmation below needs to be set manually due to dirty rsa output&quot;</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr">
            <pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">Warning</span>                                   Traceback (most recent call last)
<span class="ansi-green-fg">/var/folders/x4/45r2t3bx5l3dc_b3tm_yz7380000gn/T/ipykernel_13998/1177164807.py</span> in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">raise</span> Warning<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Sender confirmation below needs to be set manually due to dirty rsa output&#34;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">Warning</span>: Sender confirmation below needs to be set manually due to dirty rsa output</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[137]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">sender_confirmation</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;[</span><span class="se">\n</span><span class="s2">&quot;&lt;rsachunkrsa&gt; 5S*vJW]&lt;/}~!C#|rb9Gdp203+N75_7#(6D~rNm-aHE1c=hNo3ozk,_A4UZ)_eY</span><span class="se">\\</span><span class="s2">tem/</span><span class="se">\\</span><span class="s2">&quot;}:wx</span><span class="si">%o</span><span class="s2">LVwAPknU1lt*DF-(68+1U^xXvE/*HlqG#ti:]f?2l</span><span class="se">\\</span><span class="s2">n^TG77</span><span class="se">\&#39;</span><span class="s2">]Kmp+,u/z&lt;/rsachunkrsa&gt;&quot;</span><span class="se">\n</span><span class="s2">]&quot;&quot;&quot;</span> 
<span class="n">confirmation_string</span> <span class="o">=</span> <span class="n">other_person_in_the_network</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">sender_confirmation</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span> <span class="n">sender</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sender</span><span class="o">.</span><span class="n">pub</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">RSAKey</span><span class="p">):</span>
    <span class="n">confirmation_string</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">.</span><span class="n">read_from_rsa</span><span class="p">(</span><span class="n">confirmation_string</span><span class="p">)</span>
<span class="n">confirmation</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">txt2obj</span><span class="p">(</span><span class="n">confirmation_string</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">confirmation</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>[[&#39;assets&#39;,	500],
[&#39;receiver_pub&#39;,	(7313, 4603)],
[&#39;prev_hash&#39;,	000055561c459c463beba5f400067485cd6fd68ca3f860f7f35a49be7c095e4f]]
</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[138]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">receiver</span><span class="o">.</span><span class="n">pub</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">hash</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">

          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


          <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
            <pre>(7313, 4603)
000055561c459c463beba5f400067485cd6fd68ca3f860f7f35a49be7c095e4f
</pre>
          </div>
        </div>

      </div>

    </div>

  </div>
  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
          <h3 id="Adding-to-Chain">Adding to Chain<a class="anchor-link" href="#Adding-to-Chain">&#182;</a></h3>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[139]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">transaction_block</span><span class="o">.</span><span class="n">mine</span><span class="p">()</span> <span class="c1"># validation</span>
<span class="n">chain</span><span class="o">.</span><span class="n">add_block</span><span class="p">(</span><span class="n">transaction_block</span><span class="p">)</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
    <div class="jp-Cell-inputWrapper">
      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
      </div>
      <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[140]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
          <div class="CodeMirror cm-s-jupyter">
            <div class=" highlight hl-ipython3">
              <pre><span></span><span class="n">chain</span>
</pre>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="jp-Cell-outputWrapper">
      <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
      </div>


      <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child jp-OutputArea-executeResult">

          <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[140]:</div>




          <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
            <pre>{
    &#34;root_block&#34;: {
        &#34;hash&#34;: &#34;000015420debcdd55c00babc9c3a5a9c4ab22280cf9a6874986c427281dd79b9&#34;,
        &#34;data&#34;: &#34;local network&#34;
    },
    &#34;...&#34;: &#34;...&#34;,
    &#34;last_block&#34;: {
        &#34;hash&#34;: &#34;0000a07716c72426eccb891b3be357269294239927c637d5ace03bcab696d617&#34;,
        &#34;data&#34;: &#34;{&#39;timestamp&#39;: &#39;...&#34;
    }
}</pre>
          </div>

        </div>

      </div>

    </div>

  </div>
  </>